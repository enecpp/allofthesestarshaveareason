@using Microsoft.JSInterop
@inject IJSRuntime JS

<video @ref="videoElement" controls style="width: 100%; height: auto;" id="@videoId">
    <source src="@VideoUrl" type="video/mp4" />
    Your browser does not support the video tag.
</video>

@code {
    [Parameter]
    public string VideoUrl { get; set; } = string.Empty;

    private ElementReference videoElement;
    private string videoId = $"video-{Guid.NewGuid():N}";

    public async Task SeekToTime(double timeInSeconds)
    {
        await JS.InvokeVoidAsync("seekVideo", videoId, timeInSeconds);
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("eval", @"
                window.seekVideo = function(videoId, time) {
                    var video = document.getElementById(videoId);
                    if (video) video.currentTime = time;
                }
            ");
        }
    }
}
